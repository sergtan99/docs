---
title: Configuring Sink via CLI on Gateway
description: Configure a Wirepas sink on a gateway using Docker + CLI. Includes listing sinks and setting node/network parameters and keys.
---

## Overview

This guide shows how to configure a **sink** on a gateway via the CLI.

<Callout type="info" title="Prerequisites">
You have already:
<ol>
  <li>Connected to the gateway.</li>
  <li>Installed the Wirepas gateway services on the gateway.</li>
  <li>Physically connected the sink to the gateway.</li>
</ol>
</Callout>

---

## 1) Find the Docker volume for D-Bus

Use this to locate the D-Bus volume used by the transport service:

<CodeGroup>

```bash Command
docker volume ls | grep "dbus"
```

```console Output
docker volume ls | grep "dbus"
local               docker-compose_dbus-volume
```

</CodeGroup>

<Callout type="tip" title="Why this matters">
You will reference this volume (e.g., <code>docker-compose_dbus-volume</code>) in every subsequent command via
<code>-v &lt;VOLUME_NAME&gt;:/var/run/dbus</code>.
</Callout>

---

## 2) Command pattern

All configuration is done by running the transport service container and calling <code>wm-node-conf</code>.

<CodeGroup>

```bash Base pattern
docker run --rm   -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf {list|set} <options>
```

```bash Show help
docker run --rm   -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf -h
```

</CodeGroup>

<Callout type="warning" title="Important">
Stop sink services <strong>before</strong> re-configuring parameters.<br />
If you are configuring a sink for the first time, the stack on the sink is already stopped.
</Callout>

---

## 3) List sinks on the gateway

Run <code>list</code> to discover connected sinks and their current configuration. This also gives you the
<code>sink_id</code> you’ll need for subsequent commands.

<CodeGroup>

```bash Command
docker run --rm   -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf list
```

```console Example output
List of sinks:
============== [sink1] ===============
[sink_id]: sink1
[started]: True
[node_address]: 1
[node_role]: SINK, CSMA_CA 
[network_address]: 1001
[network_channel]: 1
[max_ac]: 8000
[min_ac]: 2000
[max_ac_cur]: 8000
[min_ac_cur]: 2000
[max_ch]: 40
[min_ch]: 1
[max_mtu]: 102
[hw_magic]: 6
[stack_profile]: 1
[firmware_version]: [5, 3, 0, 89]
[app_config_max_size]: 80
[are_keys_set]: False
[app_config_seq]: 0
[app_config_diag]: 0
[app_config_data]: b'0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
[stored_status]: ScratchpadStatus.SCRATCHPAD_STATUS_SUCCESS
[stored_type]: ScratchpadType.SCRATCHPAD_TYPE_BLANK
[stored_scratchpad]: {'seq': 0, 'crc': 0, 'len': 0}
[processed_scratchpad]: {'seq': 255, 'crc': 65535, 'len': 16}
[firmware_area_id]: 262
[target_and_action]: {'action': <ScratchpadAction.ACTION_NO_OTAP: 1>, 'target_sequence': 0, 'target_crc': 0, 'param': 0}
[cost]: 0
===================================
```

</CodeGroup>

<Callout type="tip" title="Before configuring">
Always run the <code>list</code> command first to confirm the correct <code>sink_id</code>, especially when multiple sinks are connected.
</Callout>

---

## 4) Configuration commands

All <code>set</code> commands share this pattern:

```bash
docker run --rm   -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set <options> -s <SINK_ID>
```

On success you’ll see:

```console
Configuration done with result = GatewayResultCode.GW_RES_OK
```

### 4.1 Set the <strong>node address</strong>

- <code>&lt;NODE_ADDRESS&gt;</code>: integer node address.

```bash
docker run --rm -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -n <NODE_ADDRESS> -s <SINK_ID>
```

### 4.2 Set the <strong>network address</strong> (and optional channel)

- <code>&lt;NETWORK_ADDRESS&gt;</code>: integer (supports hex), e.g. <code>-N 0xA1B2C3</code> or <code>-N 123456</code>.
- Optionally include <code>-c &lt;CHANNEL&gt;</code> in the same command.

<CodeGroup>

```bash Generic
docker run --rm -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -N <NETWORK_ADDRESS> [-c <CHANNEL>] -s <SINK_ID>
```

```bash Example
docker run --rm -v dual_transport_dbus-volume:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -N 2bbba2 -c 10 -s sink1
```

</CodeGroup>

### 4.3 Set the <strong>network channel</strong>

- <code>&lt;CHANNEL&gt;</code>: integer channel number (e.g., <code>5</code>).

```bash
docker run --rm -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -c <CHANNEL> -s <SINK_ID>
```

### 4.4 Set the <strong>authentication key</strong>

<Callout type="info" title="Key formats">
Provide a network‑wide 128‑bit key in one of the following formats:
<ul>
  <li>Continuous hex: <code>112233445566778899AABBCCDDEEFF11</code></li>
  <li>Comma‑separated bytes: <code>11,22,33,44,55,66,77,88,99,AA,BB,CC,DD,EE,FF,11</code></li>
</ul>
</Callout>

```bash
docker run --rm -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -ak <AUTH_KEY> -s <SINK_ID>
```

### 4.5 Set the <strong>cipher key</strong>

- <code>&lt;CIPHER_KEY&gt;</code>: network‑wide cipher key (same formats as the authentication key).

```bash
docker run --rm -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -ck <CIPHER_KEY> -s <SINK_ID>
```

### 4.6 <strong>Start / stop</strong> the sink

- <code>&lt;BOOL&gt;</code>: <code>true</code> to start, <code>false</code> to stop.

<CodeGroup>

```bash Stop
docker run --rm -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -S false -s <SINK_ID>
```

```bash Start
docker run --rm -v <VOLUME_NAME>:/var/run/dbus   wirepas/gateway_transport_service   wm-node-conf set -S true -s <SINK_ID>
```

</CodeGroup>

---

<Callout type="tip" title="Troubleshooting">
<ul>
  <li>Re-check the D-Bus volume mount: <code>-v &lt;VOLUME_NAME&gt;:/var/run/dbus</code>.</li>
  <li>Ensure sink services are stopped while reconfiguring.</li>
  <li>Confirm the correct <code>sink_id</code> using the <code>list</code> command.</li>
</ul>
</Callout>
